# Development Environment Configuration
# This file contains settings for local development
# 
# INSTRUCTIONS:
# 1. Copy this file to: application-dev.yaml
# 2. Replace YOUR_SUPABASE_HOST, YOUR_DATABASE_USERNAME, and YOUR_DATABASE_PASSWORD with your actual values
# 3. application-dev.yaml is in .gitignore (won't be committed to Git)
#
# This file overrides application.yaml for development environment

spring:
  # Application name
  application:
    name: skillbridge-backend

  # Database Configuration
  datasource:
    # JDBC connection URL to Supabase PostgreSQL
    # Format: jdbc:postgresql://HOST:PORT/DATABASE
    # Using TRANSACTION POOLER (port 6543) - IPv4 compatible
    # NOTE: Transaction pooler doesn't support prepared statements, so we'll disable them in Hibernate
    # This is a workaround for IPv4-only networks
    url: jdbc:postgresql://YOUR_SUPABASE_HOST:6543/postgres
    username: YOUR_DATABASE_USERNAME
    password: YOUR_DATABASE_PASSWORD
    
    # Connection pool settings (HikariCP - Spring Boot's default)
    hikari:
      maximum-pool-size: 10        # Max connections in pool
      minimum-idle: 5                # Min idle connections
      connection-timeout: 30000      # 30 seconds timeout
      idle-timeout: 600000          # 10 minutes
      max-lifetime: 1800000          # 30 minutes

  # JPA / Hibernate Configuration
  jpa:
    # Database dialect - tells Hibernate this is PostgreSQL
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    
    # Hibernate DDL mode
    hibernate:
      # 'none' means: Don't auto-create/update tables
      # We use Flyway migrations instead (better practice)
      ddl-auto: none
    
    # Show SQL queries in console (useful for debugging)
    show-sql: true
    
    # Format SQL queries nicely in logs
    properties:
      hibernate:
        format_sql: true
        # Use PostgreSQL-specific features
        dialect: org.hibernate.dialect.PostgreSQLDialect
        # Disable prepared statements (required for transaction pooler)
        # Transaction pooler doesn't support PREPARE statements
        jdbc:
          use_server_prepared_statement: false

  # Flyway Configuration (Database Migrations)
  flyway:
    enabled: true                    # Enable Flyway
    locations: classpath:db/migration  # Where migration files are
    baseline-on-migrate: true         # Create baseline if DB is not empty
    validate-on-migrate: true         # Validate migrations on startup

# Server Configuration
server:
  port: 8080                         # Port Spring Boot runs on

# Logging Configuration
logging:
  level:
    root: INFO
    com.skillbridge: DEBUG           # Our package - more detailed logs
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG         # Show SQL queries
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE  # Show SQL parameters

